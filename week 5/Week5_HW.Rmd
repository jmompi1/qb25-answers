---
title: "Week 5 HW"
author: "Joy Mompi"
date: "2025-10-29"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
#Step 1.1 — Load DNMs
#Load aau1043_dnm.csv into a tibble.
aau1043_dnm_df <- read_csv("~/qb25-answers/week5/aau1043_dnm.csv")


#Step 1.2 — Count DNMs by parental origin per proband
#Create a per-proband summary with counts of maternally and paternally inherited DNMs. Ignore DNMs without a specified parent of origin.
perproband_summary <- aau1043_dnm_df %>%
  filter(!is.na(Phase_combined)) %>%
  group_by(Proband_id) %>%
  summarise(
    num_maternal_inherited_dnms = sum(Phase_combined == "mother"),
    num_paternal_inherited_dnms = sum(Phase_combined == "father")
  )
    
print(perproband_summary)


#Step 1.3 — Load parental ages
#Load aau1043_parental_age.csv
aau1043_parental_age_df <- read_csv("~/qb25-answers/week5/aau1043_parental_age.csv")


#Step 1.4 — Merge counts with ages
#Join the two tibbles by proband ID.
aau1043_joined_df <- perproband_summary %>%
  left_join(aau1043_parental_age_df, by = "Proband_id")
print(aau1043_joined_df)

```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
#PART 2
#Step 2.1 — Visualize relationships
#Create a scatter plot of the count of maternal DNMs vs. maternal age → save as ex2_a.png
maternaldnms_age <- ggplot(data = aau1043_joined_df, aes(x = Mother_age, y = num_maternal_inherited_dnms)) +
  geom_point()
  ggsave("ex2_a.png", plot = maternaldnms_age, path = "~/qb25-answers/week5")
  
#Create a scatter plot of the count of paternal DNMs vs. paternal age → save as ex2_b.png
paternaldnms_age <- ggplot(data = aau1043_joined_df, aes(x = Father_age, y = num_paternal_inherited_dnms)) +
  geom_point()
  ggsave("ex2_b.png", plot = paternaldnms_age, path = "~/qb25-answers/week5")

#Step 2.2 — OLS: maternal age vs. maternal DNMs
#Fit a simple linear regression model relating maternal age to the number of maternal de novo mutations.
lm(data = aau1043_joined_df, formula = num_maternal_inherited_dnms ~ 1 + Mother_age) %>%
  summary()

#In README.md, answer: 1. What is the “size” (i.e., slope) of this relationship? Interpret the slope in plain language. Does it match your plot? 2. Is the relationship significant? How do you know? Explain the p-value in plain but precise language.

#Ans (2.2): the slope is 0.3776, which is the degree to which the number of maternal inherited de novo mutations that can be explained by the moternal age. The points on the graph are more randomly distributed. The p-value is less than 2.2x10-16, which makes this relationship significant. There is a 2.2x10-16 probability that the spread of the number of maternally-inherited dnms is due to random chance.


#Step 2.3 — OLS: paternal age vs. paternal DNMs
#Repeat the step above but for paternal age vs. paternal DNMs.
lm(data = aau1043_joined_df, formula = num_paternal_inherited_dnms ~ 1 + Father_age) %>%
  summary()

#Ans (2.3): the slope here is 1.35384, which means there is a stronger correlation between father's age and the number of paternally-inherited dnms. This makes sense because the line seems more fitted. There is a 2.2x10-16 probability that the spread of the number of maternally-inherited dnms is due to random chance (p-value). 


#Step 2.4 — Predict for a 50.5-year-old father
#Use the paternal regression model to predict the expected number of paternal DNMs for a father of age 50.5. You are welcome to do this manually or using a built-in function, but show your work in README.md.
y = mx + b
num_paternal_inherited_dnms = father_age_slope * paternal_age + y-intercept
print((1.35384*50.2)+10.32632)

#Ans (2.4): expected number of paternal DNMs is 78.289 ~ 78.


#Step 2.5 — Compare distributions of maternal vs. paternal DNMs
#Plot both distributions on the same axes as semi-transparent histograms; save as ex2_c.png

png(file = "ex2_c.png")
step_2_hist <- hist(aau1043_joined_df$num_maternal_inherited_dnms, col=rgb(1,0,0,0.5), xlim = c(0,120), xlab = "inheritance of dnms", main="frequency of the number of maternally and paternally inherited dnms")
  hist(aau1043_joined_df$num_paternal_inherited_dnms, col=rgb(0,0,1,0.5), xlim = c(0,120), add=T, xlab = "inheritance of dnms")
#blue is paternal and pink is maternal
dev.off()

#blue is paternal and pink is maternal


```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
